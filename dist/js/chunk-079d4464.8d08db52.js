(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-079d4464"],{"1dae":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"main user-layout-register"},[e._m(0),t("a-form-model",{ref:"form",attrs:{model:e.model,rules:e.validatorRules}},[t("a-form-model-item",{attrs:{prop:"username"}},[t("a-input",{attrs:{size:"large",type:"text",autocomplete:"false",placeholder:"请输入用户名"},model:{value:e.model.username,callback:function(t){e.$set(e.model,"username",t)},expression:"model.username"}})],1),t("a-popover",{attrs:{placement:"rightTop",trigger:"click",visible:e.state.passwordLevelChecked}},[t("template",{slot:"content"},[t("div",{style:{width:"240px"}},[t("div",{class:["user-register",e.passwordLevelClass]},[e._v("强度："),t("span",[e._v(e._s(e.passwordLevelName))])]),t("a-progress",{attrs:{percent:e.state.percent,showInfo:!1,strokeColor:e.passwordLevelColor}}),t("div",{staticStyle:{"margin-top":"10px"}},[t("span",[e._v("请至少输入 8 个字符。请不要使用容易被猜到的密码。")])])],1)]),t("a-form-model-item",{attrs:{prop:"password"}},[t("a-input",{attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"至少8位密码，区分大小写"},on:{click:e.handlePasswordInputClick},model:{value:e.model.password,callback:function(t){e.$set(e.model,"password",t)},expression:"model.password"}})],1)],2),t("a-form-model-item",{attrs:{prop:"password2"}},[t("a-input",{attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"确认密码"},model:{value:e.model.password2,callback:function(t){e.$set(e.model,"password2",t)},expression:"model.password2"}})],1),t("a-form-model-item",{attrs:{prop:"mobile"}},[t("a-input",{attrs:{size:"large",placeholder:"11 位手机号"},model:{value:e.model.mobile,callback:function(t){e.$set(e.model,"mobile",t)},expression:"model.mobile"}},[t("a-select",{attrs:{slot:"addonBefore",size:"large",defaultValue:"+86"},slot:"addonBefore"},[t("a-select-option",{attrs:{value:"+86"}},[e._v("+86")]),t("a-select-option",{attrs:{value:"+87"}},[e._v("+87")])],1)],1)],1),t("a-row",{attrs:{gutter:16}},[t("a-col",{staticClass:"gutter-row",attrs:{span:16}},[t("a-form-model-item",{attrs:{prop:"captcha"}},[t("a-input",{attrs:{size:"large",type:"text",placeholder:"验证码"},model:{value:e.model.captcha,callback:function(t){e.$set(e.model,"captcha",t)},expression:"model.captcha"}},[t("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1)],1),t("a-col",{staticClass:"gutter-row",attrs:{span:8}},[t("a-button",{staticClass:"getCaptcha",attrs:{size:"large",disabled:e.state.smsSendBtn},domProps:{textContent:e._s(e.state.smsSendBtn?e.state.time+" s":"获取验证码")},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.getCaptcha.apply(null,arguments)}}})],1)],1),t("a-form-model-item",[t("a-button",{staticClass:"register-button",attrs:{size:"large",type:"primary",htmlType:"submit",loading:e.registerBtn,disabled:e.registerBtn},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[e._v("注册\n      ")]),t("router-link",{staticClass:"login",attrs:{to:{name:"login"}}},[e._v("使用已有账户登录")])],1)],1)],1)},a=[function(){var e=this,t=e._self._c;return t("h3",[t("span",[e._v("注册")])])}],o=s("ac0d"),n=(s("7ded"),s("0fea")),i=s("4ec3");function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function d(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?c(Object(s),!0).forEach((function(t){u(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function u(e,t,s){return t=p(t),t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function p(e){var t=m(e,"string");return"symbol"===l(t)?t:String(t)}function m(e,t){if("object"!==l(e)||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t||"default");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var f={0:"低",1:"低",2:"中",3:"强"},h={0:"error",1:"error",2:"warning",3:"success"},v={0:"#ff0000",1:"#ff0000",2:"#ff7e05",3:"#52c41a"},w={name:"Register",components:{},mixins:[o["b"]],data:function(){return{model:{},validatorRules:{username:[{required:!1},{validator:this.checkUsername}],password:[{required:!1},{validator:this.handlePasswordLevel}],password2:[{required:!1},{validator:this.handlePasswordCheck}],mobile:[{required:!1},{validator:this.handlePhoneCheck}],captcha:[{required:!1},{validator:this.handleCaptchaCheck}]},state:{time:60,smsSendBtn:!1,passwordLevel:0,passwordLevelChecked:!1,percent:10,progressColor:"#FF0000"},registerBtn:!1}},computed:{passwordLevelClass:function(){return h[this.state.passwordLevel]},passwordLevelName:function(){return f[this.state.passwordLevel]},passwordLevelColor:function(){return v[this.state.passwordLevel]}},methods:{checkUsername:function(e,t,s){if(t){var r={username:t};Object(i["h"])(r).then((function(e){e.success?s():s("用户名已存在!")}))}else s(new Error("请输入用户名"))},handleEmailCheck:function(e,t,s){var r={email:t};Object(i["h"])(r).then((function(e){e.success?s():s("邮箱已存在!")}))},handlePasswordLevel:function(e,t,s){var r=0,a=/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[~!@#$%^&*()_+`\-={}:";'<>?,./]).{8,}$/;a.test(t)||s(new Error("密码由8位数字、大小写字母和特殊符号组成!")),/[0-9]/.test(t)&&r++,/[a-zA-Z]/.test(t)&&r++,/[^0-9a-zA-Z_]/.test(t)&&r++,this.state.passwordLevel=r,this.state.percent=30*r,r>=2?(r>=3&&(this.state.percent=100),s()):(0===r&&(this.state.percent=10),s(new Error("密码强度不够")))},handlePasswordCheck:function(e,t,s){var r=this.model["password"];void 0===t&&s(new Error("请输入密码")),t&&r&&t.trim()!==r.trim()&&s(new Error("两次密码不一致")),s()},handleCaptchaCheck:function(e,t,s){t?s():s(new Error("请输入验证码"))},handlePhoneCheck:function(e,t,s){var r=/^1[3456789]\d{9}$/;if(r.test(t)){var a={phone:t};Object(i["h"])(a).then((function(e){e.success?s():s("手机号已存在!")}))}else s(new Error("请输入正确手机号"))},handlePasswordInputClick:function(){this.isMobile()?this.state.passwordLevelChecked=!1:this.state.passwordLevelChecked=!0},handleSubmit:function(){var e=this;this.$refs["form"].validate((function(t){if(1==t){var s=e.model,r={username:s.username,password:s.password,phone:s.mobile,smscode:s.captcha};Object(n["i"])("/sys/user/register",r).then((function(t){t.success?e.$router.push({name:"registerResult",params:d({},s)}):e.registerFailed(t.message)}))}}))},getCaptcha:function(e){var t=this;e.preventDefault();var s=this;this.$refs["form"].validateField(["mobile"],(function(e){if(!e){t.state.smsSendBtn=!0;var r=window.setInterval((function(){s.state.time--<=0&&(s.state.time=60,s.state.smsSendBtn=!1,window.clearInterval(r))}),1e3),a=t.$message.loading("验证码发送中..",3),o={mobile:t.model.mobile,smsmode:"1"};Object(n["i"])("/sys/sms",o).then((function(e){e.success||(t.registerFailed(e.message),setTimeout(a,0)),setTimeout(a,500)})).catch((function(e){setTimeout(a,1),clearInterval(r),s.state.time=60,s.state.smsSendBtn=!1,t.requestFailed(e)}))}}))},registerFailed:function(e){this.$notification["error"]({message:"注册失败",description:e,duration:2})},requestFailed:function(e){this.$notification["error"]({message:"错误",description:((e.response||{}).data||{}).message||"请求出现错误，请稍后再试",duration:4}),this.registerBtn=!1}},watch:{"state.passwordLevel":function(e){}}},b=w,g=(s("98f1"),s("6570"),s("2877")),y=Object(g["a"])(b,r,a,!1,null,"13571778",null);t["default"]=y.exports},6570:function(e,t,s){"use strict";s("b0de")},8444:function(e,t,s){},"98f1":function(e,t,s){"use strict";s("8444")},b0de:function(e,t,s){}}]);