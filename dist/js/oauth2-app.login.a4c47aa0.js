(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["oauth2-app.login"],{5193:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this;t._self._c;return t._m(0)},o=[function(){var t=this,e=t._self._c;return e("div",[e("div",{attrs:{id:"loader-wrapper"}},[e("div",{attrs:{id:"loader"}}),e("div",{staticClass:"loader-section section-left"}),e("div",{staticClass:"loader-section section-right"}),e("div",{staticClass:"load_title"},[t._v("正在登录 计件好帮手平台，请耐心等待")])])])}],r=n("2f62"),s=n("ca00"),c=n("9fb0");function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return e=d(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t){var e=f(t,"string");return"symbol"===a(e)?e:String(e)}function f(t,e){if("object"!==a(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==a(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var p={name:"OAuth2Login",data:function(){return{env:{thirdApp:!1,wxWork:!1,dingtalk:!1}}},beforeCreate:function(){Object(s["i"])()||this.$router.replace({path:"/user/login"})},created:function(){this.checkEnv(),this.doOAuth2Login()},methods:h(h({},Object(r["b"])(["ThirdLogin"])),{},{checkEnv:function(){/wxwork/i.test(navigator.userAgent)&&(this.env.thirdApp=!0,this.env.wxWork=!0),/dingtalk/i.test(navigator.userAgent)&&(this.env.thirdApp=!0,this.env.dingtalk=!0)},doOAuth2Login:function(){if(this.env.thirdApp)if(this.$route.query.oauth2LoginToken){this.thirdType=this.$route.query.thirdType;var t=this.$route.query.oauth2LoginToken;this.doThirdLogin(t)}else this.env.wxWork?this.doWechatEnterpriseOAuth2Login():this.env.dingtalk&&this.doDingTalkOAuth2Login()},doThirdLogin:function(t){var e=this,n={};n.thirdType=this.thirdType,n.token=t,this.ThirdLogin(n).then((function(t){t.success?e.loginSuccess():e.requestFailed(t)}))},loginSuccess:function(){this.$router.replace({path:c["n"]}),this.$notification.success({message:"欢迎",description:"".concat(Object(s["p"])(),"，欢迎回来")})},requestFailed:function(t){this.$error({title:"登录失败",content:((t.response||{}).data||{}).message||t.message||"请求出现错误，请稍后再试",okText:"重新登陆",onOk:function(){window.location.reload()},onCancel:function(){window.location.reload()}})},doWechatEnterpriseOAuth2Login:function(){this.sysOAuth2Login("wechat_enterprise")},doDingTalkOAuth2Login:function(){this.sysOAuth2Login("dingtalk")},sysOAuth2Login:function(t){var e="".concat(window._CONFIG["domianURL"],"/sys/thirdLogin/oauth2/").concat(t,"/login");e+="?state=".concat(encodeURIComponent(window.location.origin)),window.location.href=e}})},g=p,b=n("2877"),v=Object(b["a"])(g,i,o,!1,null,"901104dc",null);e["default"]=v.exports}}]);